\documentclass[a4paper]{article}
\usepackage{ctex}
\usepackage[affil-it]{authblk}
\usepackage[backend=bibtex,style=numeric]{biblatex}
\usepackage{amsmath,amsthm,amssymb,amsfonts}
\usepackage{mathrsfs}
\usepackage{bm}
\usepackage{graphicx}
\usepackage{geometry}

\geometry{margin=1.5cm, vmargin={0pt,1cm}}
\setlength{\topmargin}{-1cm}
\setlength{\paperheight}{29.7cm}
\setlength{\textheight}{25.3cm}

\addbibresource{citation.bib}

\newcommand{\Rmnum}[1]{\uppercase\expandafter{\romannumeral #1}}  
\newcommand{\rmnum}[1]{\romannumeral #1}

\begin{document}
% =================================================
\title{Mie 散射理论}

\author{zsh945
  \thanks{邮箱: \texttt{3097714673@qq.com}}}

\date{更新时间: \today}

\maketitle

% ============================================
\section{经典理论\cite{bohren2008absorption}}

\par 先推导矢量波方程，然后在球坐标系和柱坐标系下分别求解。

\subsection{矢量波方程}
\par 假设介质是线性、各向同性和均匀的，并且考虑无源的情况，我们要研究的有矢量波方程：
\begin{gather}
    \nabla^2 \bm{E} + k^2\bm{E}=\bm{0}\\
    \nabla^2 \bm{H} + k^2\bm{H}=\bm{0}
\end{gather}
\par 其中 $k^2=\omega^2\varepsilon\mu$，以及 Maxwell 方程组：
\begin{gather}
    \nabla \cdot \bm{E} = 0,
    \qquad\nabla \cdot \bm{H} = 0\\
    \nabla \times \bm{E} = i\omega\mu \bm{H},
    \qquad\nabla \times \bm{H} = -i\omega\varepsilon \bm{E}
\end{gather}
\par 下面构造上述方程的猜测解，令 $\bm{M}=\nabla\times(\bm{c}\psi)$，
以及 $\bm{N}=\dfrac{\nabla\times\bm{M}}{k}$，其中 $\bm{c}$ 是一个常数矢量，
$\psi$ 是一个标量函数。显然 $\bm{M}$ 和 $\bm{N}$ 是无散的，并且有
\begin{gather}
    \nabla^2 \bm{M} + k^2\bm{M}=\nabla\times\left[
        \bm{c}\left(\nabla^2\psi + k^2 \psi\right)
    \right]\\
    \nabla^2 \bm{N} + k^2\bm{N}=\nabla\times\left[
        \dfrac{1}{k}\left(\nabla^2\bm{M} + k^2 \bm{M}\right)
    \right]
\end{gather}
\par 可以约束 $\psi$ 使得 $\nabla^2\psi + k^2\psi=0$，这样 $\bm{M}$ 和 $\bm{N}$
便满足矢量波方程。
\begin{gather}
    \nabla\times\bm{M}=k\bm{N}\\
    \nabla\times\bm{N}=\dfrac{\nabla\times\nabla\times\bm{M}}{k}
    =\dfrac{\nabla(\nabla\cdot\bm{M})-\nabla^2\bm{M}}{k}=k\bm{M}
\end{gather}
\par 因此我们只需找到 $\bm{c}$ 和 $\psi$ 就可以得到矢量波方程的解。 

\subsection{球坐标系}

\subsubsection{生成函数}

\par 在球坐标系下 $\psi$ 的波方程可以具体写为
\begin{equation}
    \frac{1}{r^2}\frac{\partial}{\partial r}
    \left(r^2\frac{\partial \psi}{\partial r}\right)
    +\frac{1}{r^2\sin \theta}\frac{\partial}{\partial \theta}
    \left(\sin \theta\frac{\partial \psi}{\partial \theta}\right)
    +\frac{1}{r^2\sin^2 \theta}\frac{\partial^2 \psi}{\partial \phi^2}
    +k^2\psi = 0
\end{equation}
\par 利用分离变量法，设 $\psi(r,\theta,\phi)=R(r)\Theta(\theta)\Phi(\phi)$ 代入可得
\begin{gather}
    \label{eq:azimuthal}
    \frac{\text{d}^2 \Phi}{\text{d} \phi^2}+m^2\phi^2=0\\
    \label{eq:legendre}
    \frac{1}{\sin\theta}\frac{\text{d}}{\text{d}\theta}
    \left(\sin\theta\frac{\text{d}\Theta}{\text{d}\theta}\right)
    +\left[n(n+1)-\frac{m^2}{\sin^2\theta}\right]\Theta=0\\
    \label{eq:spherical_bessel}
    \frac{\text{d}}{\text{d}r}\left(r^2\frac{\text{d}R}{\text{d}r}\right)
    +\left[k^2r^2-n(n+1)\right]R=0
\end{gather}

\begin{itemize}
    \item 方位角函数
        \par 对于式 \eqref{eq:azimuthal}，解为
        \begin{gather}
            \Phi_e(\phi)=\cos m\phi\\
            \Phi_o(\phi)=\sin m\phi
        \end{gather}
        \par 为了使得 $\Phi(\phi)$ 在 $\phi$ 方向上是周期为 $2\pi$ 的函数，$m$ 必须是整数。
        由于 $m$ 和 $-m$ 对应的解是等价的，只需考虑$m$为非负整数。
    \item 连带勒让德函数
        \par 对于式 \eqref{eq:legendre}，解为连带勒让德函数 $P_n^m(\cos\theta)$，其中
        $n= m,m+1,\cdots$。连带勒让德函数具有正交性：
        \begin{equation}
            \int_{-1}^1 P_n^m(x)P_{n'}^m(x) \text{d}x
            =\frac{2}{2n+1}\frac{(n+m)!}{(n-m)!}\delta_{nn'}
        \end{equation}
        \par 其中 $x=\cos\theta$。
    \item 球贝塞尔函数
        \par 定义变量 $\rho=kr$ 和函数 $Z=R\sqrt{\rho}$ ，式 \eqref{eq:spherical_bessel} 可写为
        \begin{equation}
            \rho\frac{\text{d}}{\text{d}\rho}\left(\rho\frac{\text{d}Z}{\text{d}\rho}\right)
            +\left[\rho^2-\left(n+\frac{1}{2}\right)^2\right]Z=0
        \end{equation}
        \par 该方程的解为半整数阶贝塞尔函数，记为 $J_v$ 和 $Y_v$，其中 $v=n+\dfrac{1}{2}$。
        定义球贝塞尔函数为
        \begin{gather}
            j_n(\rho)=\sqrt{\dfrac{\pi}{2\rho}}J_{n+\frac{1}{2}}(\rho)\\
            y_n(\rho)=\sqrt{\dfrac{\pi}{2\rho}}Y_{n+\frac{1}{2}}(\rho)
        \end{gather}
        \par 另外定义球汉克尔函数为
        \begin{gather}
            h_n^{(1)}(\rho)=j_n(\rho)+iy_n(\rho)\\
            h_n^{(2)}(\rho)=j_n(\rho)-iy_n(\rho)
        \end{gather}
        \par 这两者同样是互相等价的。
\end{itemize}

\par 现在终于可以给出生成函数了，定义
\begin{gather}
    \psi_{emn}= \cos m\phi P_n^m(\cos\theta) z_n(kr)\\
    \psi_{omn}= \sin m\phi P_n^m(\cos\theta) z_n(kr)
\end{gather}
\par 其中 $z_n$ 可以是任意一种球贝塞尔函数。 取 $\bm{c}=\bm{r}$ 于是可以得到矢量波方程的解：
\begin{gather}
    \bm{M}_{emn}=\nabla\times(\bm{r}\psi_{emn}),
    \qquad\bm{M}_{omn}=\nabla\times(\bm{r}\psi_{omn})\\
    \bm{N}_{emn}=\dfrac{\nabla\times\bm{M}_{emn}}{k},
    \qquad\bm{N}_{omn}=\dfrac{\nabla\times\bm{M}_{omn}}{k}
\end{gather}
\par 通过球坐标系下的旋度算子，可以计算得到具体形式：
\begin{equation}
    \begin{aligned}        
        \bm{M}_{emn} =&\ \frac{-m}{\sin \theta} \sin m\phi P_n^m(\cos \theta) z_n(\rho) \bm{\hat{e}_\theta} \\
        &\ -\cos m\phi \frac{\text{d} P_n^m(\cos \theta)}{\text{d} \theta} z_n(\rho) \bm{\hat{e}_\phi}
    \end{aligned}
\end{equation}
\begin{equation}
    \begin{aligned}        
        \bm{M}_{omn} =&\ \frac{m}{\sin \theta} \cos m\phi P_n^m(\cos \theta) z_n(\rho) \bm{\hat{e}_\theta} \\
        &\ -\sin m\phi \frac{\text{d} P_n^m(\cos \theta)}{\text{d} \theta} z_n(\rho) \bm{\hat{e}_\phi}
    \end{aligned}
\end{equation}
\begin{equation}
    \begin{aligned}        
        \bm{N}_{emn} =&\ n(n+1) \cos m\phi \frac{P_n^m(\cos \theta)}{\rho} z_n(\rho) \bm{\hat{e}_r}    \\
        &\ +\cos m\phi \frac{\text{d} P_n^m(\cos \theta)}{\text{d} \theta} \frac{1}{\rho} \frac{\text{d}}{\text{d} \rho}[\rho z_n(\rho)] \bm{\hat{e}_\theta} \\
        &\ -m\sin m\phi \frac{P_n^m(\cos \theta)}{\sin \theta} \frac{1}{\rho} \frac{\text{d}}{\text{d} \rho}[\rho z_n(\rho)] \bm{\hat{e}_\phi}
    \end{aligned}
\end{equation}
\begin{equation}
    \begin{aligned}        
        \bm{N}_{omn} =&\ n(n+1) \sin m\phi \frac{P_n^m(\cos \theta)}{\rho} z_n(\rho) \bm{\hat{e}_r} \\
        &\ +\sin m\phi \frac{\text{d} P_n^m(\cos \theta)}{\text{d} \theta} \frac{1}{\rho} \frac{\text{d}}{\text{d} \rho}[\rho z_n(\rho)] \bm{\hat{e}_\theta} \\
        &\ +m \cos m\phi \frac{P_n^m(\cos \theta)}{\sin \theta} \frac{1}{\rho} \frac{\text{d}}{\text{d} \rho}[\rho z_n(\rho)] \bm{\hat{e}_\phi}
    \end{aligned}
\end{equation}

\subsubsection{级数展开}

\par 考虑一个平面波沿 $z$ 方向传播，电场极化方向为 $x$ 方向的情况：
\begin{equation}
    \begin{aligned}
        \bm{E}_i &= E_0 e^{ikr\cos\theta}\bm{\hat{e}_x}  \\
        &= E_0 e^{ikr\cos\theta}(\sin\theta\cos\phi \bm{\hat{e}_r}
        +\cos\theta\cos\phi \bm{\hat{e}_\theta} - \sin\phi \bm{\hat{e}_\phi})
    \end{aligned}
    \label{eq:PlanarWave}
\end{equation}
\par 对其进行级数展开，有
\begin{equation}
    \bm{E}_i = \sum_{m=0}^{\infty}\sum_{n=m}^{\infty}
    \left(
        B_{emn}\bm{M}_{emn}+B_{omn}\bm{M}_{omn}+A_{emn}\bm{N}_{emn}+A_{omn}\bm{N}_{omn}
    \right)
\end{equation}

\par 需要证明上面的基函数组满足正交关系：
\begin{itemize}
    \item 由于 $\sin m\phi$ 和 $\cos m\phi$ 在 $[0,2\pi]$ 上正交，有
        \begin{equation}
            \int_{0}^{2\pi}\int_{0}^{\pi}\bm{M}_{emn}\cdot\bm{M}_{om'n'} 
            \sin\theta \text{d}\theta \text{d}\phi = 0
            \qquad \text{对于所有的\ } m,n,m',n'
        \end{equation}
        类似地可以证明 $(\bm{N}_{emn}, \bm{N}_{omn})$， $(\bm{M}_{emn}, \bm{N}_{emn})$，$(\bm{M}_{omn}, \bm{N}_{omn})$ 的正交性。
    \item 另外需要证明 $(\bm{M}_{emn}, \bm{N}_{omn})$ 和 $(\bm{M}_{omn}, \bm{N}_{emn})$ 的正交性，
        以前者为例即证明
        \begin{equation}
            \int_{0}^{2\pi}\int_{0}^{\pi}\bm{M}_{emn}\cdot\bm{N}_{om'n'} 
            \sin\theta \text{d}\theta \text{d}\phi = 0
            \qquad \text{对于所有的\ } m,n,m',n'
        \end{equation}
        \par 由于当 $m\neq m'$ 时，$\sin m\phi$ 和 $\sin m'\phi$，$\cos m\phi$ 和 $\cos m'\phi$ 正交，因此只需考虑 $m=m'$ 的情况。
        通过具体计算，可以发现关于 $\theta$ 的积分为
        \begin{equation}
            m\int_{0}^{\pi}\left(
                P_n^m(\cos \theta) \frac{\text{d}P_{n'}^m(\cos \theta)}{\text{d}\theta}
                +P_{n'}^m(\cos \theta) \frac{\text{d}P_{n}^m(\cos \theta)}{\text{d}\theta}
            \right) \text{d}\theta
            =\Big.P_n^m(\cos \theta)P_{n'}^m(\cos \theta)\Big|_0^{\pi}
        \end{equation}
        由于上式左边有 $m$ 的乘积因子，当 $m=0$ 时式子为 0。当
        $m\neq 0$ 时，根据连带勒让德函数的微分公式有
        \begin{equation}
            P_n^m(x) = (1-x^2)^{\frac{m}{2}}\frac{\text{d}^m P_n(x)}{\text{d}x^m}
        \end{equation}
        其中 $x=\cos\theta$。当 $\theta=0$ 或 $\theta=\pi$ 时，$x=\pm 1$，因此
        $P_n^m(\cos \theta)=0$。
    \item 还剩下需要证明，对于 $m\neq m'$ 或者 $n\neq n'$ 基函数与自身的积分为 0，
        同样用于三角函数族的正交性，只需要证明 $n\neq n'$ 的情况
        \begin{gather}
            \int_{0}^{2\pi}\int_{0}^{\pi}\bm{M}_{emn}\cdot\bm{M}_{emn'} \sin\theta \text{d}\theta \text{d}\phi
            =\int_{0}^{2\pi}\int_{0}^{\pi}\bm{M}_{omn}\cdot\bm{M}_{omn'} \sin\theta \text{d}\theta \text{d}\phi=0\\
            \int_{0}^{2\pi}\int_{0}^{\pi}\bm{N}_{emn}\cdot\bm{N}_{emn'} \sin\theta \text{d}\theta \text{d}\phi
            =\int_{0}^{2\pi}\int_{0}^{\pi}\bm{N}_{omn}\cdot\bm{N}_{omn'} \sin\theta \text{d}\theta \text{d}\phi=0
        \end{gather}
        以第一个式子为例，通过具体计算，可以发现关于 $\theta$ 的积分为
        \begin{equation}
            \int_{0}^{\pi}\left(
                \frac{m^2}{\sin^2\theta} P_n^m P_{n'}^m
                +\frac{\text{d}P_n^m}{\text{d}\theta}
                \frac{\text{d}P_{n'}^m}{\text{d}\theta}
            \right) \sin\theta \text{d}\theta
        \end{equation}
        \par 当 $m\neq 0$ 时，利用连带勒让德函数的微分方程 \eqref{eq:legendre}，
        可以将上式化简为
        \begin{equation}
            \int_{0}^{\pi} n(n+1) P_n^m(\cos \theta) P_{n'}^m(\cos \theta) \sin\theta \text{d}\theta
            +\frac{1}{2}\int_{0}^{\pi}
            \frac{\text{d}}{\text{d}\theta}\left(
                \sin\theta\frac{\text{d}P_{n'}^m}{\text{d}\theta}P_{n}^m
                +\sin\theta\frac{\text{d}P_{n}^m}{\text{d}\theta}P_{n'}^m
            \right)\text{d}\theta
        \end{equation}
        \par 由连带勒让德函数的正交性可知第一个积分为 0，第二个积分也容易计算得到为 0。
        当 $m=0$ 时有 $\bm{M}_{omn}=\bm{N}_{omn}=\bm{0}$，而 $\bm{M}_{emn}$ 和 $\bm{N}_{emn}$ 的正交性
        的证明与 $m\neq 0$ 时类似。
\end{itemize}

\par 得到了上述正交关系后，可以计算展开系数：
\begin{equation}
    B_{emn} = \frac{\int_{0}^{2\pi}\int_{0}^{\pi}\bm{E}_i\cdot\bm{M}_{emn} \sin\theta \text{d}\theta \text{d}\phi}
    {\int_{0}^{2\pi}\int_{0}^{\pi}|\bm{M}_{emn}|^2 \sin\theta \text{d}\theta \text{d}\phi}
\end{equation}
\par 注意到式 \eqref{eq:PlanarWave} 中带有 $\cos\phi$ 和 $\sin\phi$，因此
只有当 $m=1$ 时分子积分不为 0。
\begin{equation}
    \bm{E}_i=\sum_{n=1}^{\infty}\left(
        B_{o1n}\bm{M}_{o1n}^{(1)}+A_{e1n}\bm{N}_{e1n}^{(1)}
    \right)
\end{equation}
\par 这里上标 $(1)$ 表示选取球贝塞尔函数 $j_n$，这是由物理含义决定的，
因为只有$j_n(kr)$在$r=0$处为有限值，而另外三种球函数在$r=0$处发散。
\par 这里以 $B_{o1n}$ 为例，为了具体计算展开系数，需要先计算其分子部分：
\begin{equation}
    \begin{aligned}
        \int_{0}^{2\pi}\int_{0}^{\pi}\bm{E}_i\cdot\bm{M}_{o1n}^{(1)} \sin\theta \text{d}\theta \text{d}\phi
        &=E_0j_n(kr)\int_{0}^{2\pi}\int_{0}^{\pi}e^{ikr\cos\theta}\left[
            \frac{\cos\theta}{\sin\theta}\cos^2\phi P_n^1(\cos\theta) 
            +\sin^2\phi \frac{\text{d}P_n^1(\cos\theta)}{\text{d}\theta} 
        \right] \sin\theta \text{d}\theta \text{d}\phi\\
        &=\pi E_0j_n(kr)\int_{0}^{\pi}e^{ikr\cos\theta}\left[
            \frac{\cos\theta}{\sin\theta}P_n^1(\cos\theta) 
            +\frac{\text{d}P_n^1(\cos\theta)}{\text{d}\theta} 
        \right] \sin\theta \text{d}\theta\\
        &=\pi E_0j_n(kr)\int_{0}^{\pi}e^{ikr\cos\theta}
            \frac{\text{d}}{\text{d}\theta} \left[
            \sin\theta P_n^1(\cos\theta) 
        \right] \text{d}\theta\\
        &=-\pi E_0j_n(kr)\int_{0}^{\pi}e^{ikr\cos\theta}
            \frac{\text{d}}{\text{d}\theta} \left[
            \sin\theta \frac{\text{d}P_n(\cos\theta)}{\text{d}\theta}
        \right] \text{d}\theta\\
        &=\pi n(n+1)E_0j_n(kr)\int_{0}^{\pi}e^{ikr\cos\theta}
            P_n(\cos\theta)\sin\theta \text{d}\theta\\
        &=2\pi n(n+1)E_0 i^n j_n^2(kr)
    \end{aligned}
\end{equation}
\par 最后一步是由于有以下等式成立：
\begin{equation}
    j_n(kr)=\frac{i^{-n}}{2}\int_{0}^{\pi}e^{ikr\cos\theta}P_n(\cos\theta)\sin\theta \text{d}\theta
\end{equation}
\par 分母部分的计算如下：
\begin{equation}
    \begin{aligned}
        \int_{0}^{2\pi}\int_{0}^{\pi}|\bm{M}_{o1n}^{(1)}|^2 \sin\theta \text{d}\theta \text{d}\phi
        &=j_n^2(kr)\int_{0}^{2\pi}\int_{0}^{\pi}\left[
            \frac{1}{\sin^2\theta}\cos^2\phi\left(
                P_n^1(\cos\theta)
            \right)^2
            +\sin^2\phi\left(
                \frac{\text{d}P_n^1(\cos\theta)}{\text{d}\theta}
            \right)^2
        \right] \sin\theta \text{d}\theta \text{d}\phi\\
        &=\pi j_n^2(kr)\int_{0}^{\pi}\left[
            \frac{1}{\sin^2\theta}\left(
                P_n^1(\cos\theta)
            \right)^2
            +\left(
                \frac{\text{d}P_n^1(\cos\theta)}{\text{d}\theta}
            \right)^2
        \right] \sin\theta \text{d}\theta \\
        &=\pi j_n^2(kr)\int_{0}^{\pi} n(n+1) \left(
                P_n^1(\cos\theta)
            \right)^2 \sin\theta \text{d}\theta\\
        &=\frac{2\pi n^2(n+1)^2}{2n+1} j_n^2(kr)
    \end{aligned}
\end{equation}
\par 通过一系列繁琐的计算，可以得到展开系数为
\begin{gather}
    B_{o1n} = i^n E_0 \frac{2n+1}{n(n+1)}\\
    A_{e1n} = -i E_0 i^n \frac{2n+1}{n(n+1)}
\end{gather}
\par 于是最终的平面波展开式为
\begin{equation}
    \bm{E}_i = E_0 \sum_{n=1}^{\infty} i^n \frac{2n+1}{n(n+1)}
    \left(\bm{M}_{o1n}^{(1)} - i \bm{N}_{e1n}^{(1)}\right)
\end{equation}

\subsubsection{散射场与内部场计算}

\par 假设散射体是一个半径为 $a$ 的均匀球体，入射波为上面的平面波，
其磁场为：
\begin{equation}
    \begin{aligned}
        \bm{H}_i=\frac{1}{i\omega\mu}\nabla\times\bm{E}_i
        &=\frac{1}{i\omega\mu}E_0 \sum_{n=1}^{\infty} i^n \frac{2n+1}{n(n+1)}
        \left(\nabla\times\bm{M}_{o1n}^{(1)} - i \nabla\times\bm{N}_{e1n}^{(1)}\right)\\
        &=\frac{-k}{\omega\mu}E_0 \sum_{n=1}^{\infty} i^n \frac{2n+1}{n(n+1)}
        \left(\bm{M}_{e1n}^{(1)} + i \bm{N}_{o1n}^{(1)}\right)\\
    \end{aligned}
\end{equation}
\par 在分界面处有边界条件：
\begin{equation}
    (\bm{E}_i+\bm{E}_s-\bm{E}_1)\times \bm{\hat{e}_r} =
    (\bm{H}_i+\bm{H}_s-\bm{H}_1)\times \bm{\hat{e}_r} = 0
\end{equation}
\par 根据正交性条件，可以假定散射场和内部场的级数展开式：
\begin{gather}
    \bm{E}_1 = \sum_{n=1}^{\infty} E_n
    \left(c_n \bm{M}_{o1n}^{(1)} - i d_n \bm{N}_{e1n}^{(1)}\right)\\
    \bm{H}_1 = \frac{-k_1}{\omega\mu_1}\sum_{n=1}^{\infty} E_n
    \left(d_n \bm{M}_{e1n}^{(1)} + i c_n \bm{N}_{o1n}^{(1)}\right)
\end{gather}
\par 其中 $k_1$ 和 $\mu_1$ 是球体内部的波数和磁导率，$E_n=i^n E_0 \dfrac{2n+1}{n(n+1)}$。
这里上标 $(1)$ 表示选取球贝塞尔函数 $j_n$，同样是由物理含义决定的。
\begin{gather}
    \bm{E}_s = \sum_{n=1}^{\infty} E_n
    \left(ia_n \bm{N}_{e1n}^{(3)} - b_n \bm{M}_{o1n}^{(3)}\right)\\
    \bm{H}_s = \frac{k}{\omega\mu}\sum_{n=1}^{\infty} E_n
    \left(ib_n \bm{N}_{o1n}^{(3)} + a_n \bm{M}_{e1n}^{(3)}\right)
\end{gather}
\par 这里上标 $(3)$ 表示选取球汉克尔函数 $h_n^{(1)}$。对于球外区域，$j_n(kr)$ 和 $y_n(kr)$
均是良定义的，因此 $h_n^{(1)}(kr)$ 和 $h_n^{(2)}(kr)$ 也是良定义的，所以可以选取球汉克尔函数
作为基函数。$h_n^{(1)}(kr)$ 在无穷远处表现为向外辐射的球面波，而
$h_n^{(2)}(kr)$ 则表现为向内辐射的球面波，因此只能选取 $h_n^{(1)}(kr)$。
\par 为了方便起见，记 $\pi_n = \dfrac{P_n^1}{\sin \theta}$ 和 $\tau_n = \dfrac{\text{d}P_n^1}{\text{d}\theta}$，
写出基函数的具体分量：
\begin{equation}
    \bm{M}_{e1n} = -\sin \phi \pi_n(\cos \theta) z_n(\rho) \bm{\hat{e}_\theta}
    -\cos \phi \tau_n(\cos \theta) z_n(\rho) \bm{\hat{e}_\phi}
\end{equation}
\begin{equation}
    \bm{M}_{o1n} =\cos \phi \pi_n(\cos \theta) z_n(\rho) \bm{\hat{e}_\theta}
    -\sin \phi \tau_n(\cos \theta) z_n(\rho) \bm{\hat{e}_\phi}
\end{equation}
\begin{equation}
    \bm{N}_{e1n} = n(n+1) \cos \phi \sin \theta \pi_n(\cos \theta)\frac{z_n(\rho)}{\rho}  \bm{\hat{e}_r}    
    +\cos \phi \tau_n(\cos \theta) \frac{[\rho z_n(\rho)]'}{\rho} \bm{\hat{e}_\theta} 
    -\sin \phi \pi_n(\cos \theta) \frac{[\rho z_n(\rho)]'}{\rho} \bm{\hat{e}_\phi}
\end{equation}
\begin{equation}
    \bm{N}_{o1n} = n(n+1) \sin \phi \sin \theta \pi_n(\cos \theta)\frac{z_n(\rho)}{\rho}  \bm{\hat{e}_r} 
    +\sin \phi \tau_n(\cos \theta) \frac{[\rho z_n(\rho)]'}{\rho} \bm{\hat{e}_\theta}    
    -\cos \phi \pi_n(\cos \theta) \frac{[\rho z_n(\rho)]'}{\rho} \bm{\hat{e}_\phi}
\end{equation}

\par 为了解出系数 $a_n,b_n,c_n,d_n$，将上述场代入边界条件中，
并利用基函数的正交性，可以得到在 $r=a$ 处有以下式子成立：
\begin{gather}
    E_{i\theta}+E_{s\theta}=E_{1\theta},
    \qquad E_{i\phi}+E_{s\phi}=E_{1\phi}\\
    H_{i\theta}+H_{s\theta}=H_{1\theta},
    \qquad H_{i\phi}+H_{s\phi}=H_{1\phi}
\end{gather}
\par 通过具体计算，可以得到四个方程：
\begin{gather}
j_n(\beta x) c_n + h_n^{(1)}(x) b_n = j_n(x)\\
\mu \left[ \beta x j_n(\beta x) \right]' c_n + \mu_1 \left[ x h_n^{(1)}(x) \right]' b_n = \mu_1 \left[ x j_n(x) \right]'\\
\mu \beta j_n(\beta x) d_n + \mu_1 h_n^{(1)}(x) a_n = \mu_1 j_n(x)\\
\left[ \beta x j_n(\beta x) \right]' d_n + \beta \left[ x h_n^{(1)}(x) \right]' a_n = \beta \left[ x j_n(x) \right]'
\end{gather}
\par 其中 $x=ka$，$\beta=\dfrac{k_1}{k}$。利用线性代数的知识可以解出系数：
\begin{gather}
    a_n = \frac{\mu \beta^2 j_n(\beta x) \left[ x j_n(x) \right]' - \mu_1 j_n(x) \left[ \beta x j_n(\beta x) \right]'}
    {\mu \beta^2j_n(\beta x) \left[ x h_n^{(1)}(x) \right]' - \mu_1 h_n^{(1)}(x) \left[ \beta x j_n(\beta x) \right]'}\\
    b_n = \frac{\mu_1 j_n(\beta x) \left[ x j_n(x) \right]' - \mu j_n(x) \left[ \beta x j_n(\beta x) \right]'}
    {\mu_1 j_n(\beta x) \left[ x h_n^{(1)}(x) \right]' - \mu h_n^{(1)}(x) \left[ \beta x j_n(\beta x) \right]'}\\
    c_n = \frac{\mu_1 j_n(x) \left[ x h_n^{(1)}(x) \right]' - \mu_1 h_n^{(1)}(x)\left[ x j_n(x) \right]'}
    {\mu_1 j_n(\beta x) \left[ x h_n^{(1)}(x) \right]' - \mu h_n^{(1)}(x) \left[ \beta x j_n(\beta x) \right]'}\\
    d_n = \frac{\mu_1 \beta j_n(x)\left[ x h_n^{(1)}(x) \right]' j_n(x) - \mu_1 \beta h_n^{(1)}(x) \left[ x j_n(x) \right]'}
    {\mu \beta^2j_n(\beta x) \left[ x h_n^{(1)}(x) \right]' - \mu_1 h_n^{(1)}(x) \left[ \beta x j_n(\beta x) \right]'}
\end{gather}

\subsection{柱坐标系}

\subsubsection{生成函数}
\par 在柱坐标系下 $\psi$ 的波方程可以具体写为
\begin{equation}
    \frac{1}{r}\frac{\partial}{\partial r}
    \left(r\frac{\partial \psi}{\partial r}\right)
    +\frac{1}{r^2}\frac{\partial^2 \psi}{\partial \phi^2}
    +\frac{\partial^2 \psi}{\partial z^2}
    +k^2\psi = 0
\end{equation}
\par 利用分离变量法，设 $\psi(r,\phi,z)=R(r)\Phi(\phi)Z(z)$ 代入可得
\begin{gather}
    \frac{\text{d}^2 \Phi}{\text{d} \phi^2}+n^2\phi^2=0\\
    \frac{\text{d}^2 Z}{\text{d} \phi^2}+h^2Z^2=0\\
    r\frac{\text{d}}{\text{d}r}\left(r\frac{\text{d}R}{\text{d}r}\right)
    +\left[(k^2-h^2)r^2-n^2\right]R=0
\end{gather}
\par 注意这里 $n$ 是整数，但 $h^2$ 可以是任意实数。不难得到生成函数为
\begin{equation}
    \psi_{n}(r,\phi,z)=
    Z_n(\rho)e^{in\phi}e^{ihz}
\end{equation}
\par 其中 $\rho=\sqrt{k^2-h^2}r$，$Z_n$ 是贝塞尔方程的解 $J_n$ 
和 $Y_n$ 中的任意一种：
\begin{equation}
    \rho\frac{\text{d}}{\text{d}\rho}\left(\rho\frac{\text{d}R}{\text{d}\rho}\right)
    +\left[\rho^2-n^2\right]R=0
\end{equation}
\par 取 $\bm{c}=\bm{\hat{e}_z}$ 于是可以得到矢量波方程的解：
\begin{gather}
    \bm{M}_{n}=\nabla\times(\bm{\hat{e}_z}\psi_n),
    \qquad\bm{N}_{n}=\frac{\nabla\times\bm{M}_n}{k}
\end{gather}
\par 通过柱坐标系下的旋度算子，可以计算得到具体形式：
\begin{equation}
    \bm{M}_n =
    \sqrt{k^2-h^2}\left(
        in\frac{Z_n(\rho)}{\rho} \bm{\hat{e}_r}
        -\frac{\text{d}Z_n(\rho)}{\text{d}\rho} \bm{\hat{e}_\phi}
    \right)e^{i(n\phi+hz)}
\end{equation}
\begin{equation}
    \bm{N}_n =
        \frac{\sqrt{k^2-h^2}}{k}\left(
            ih\frac{\text{d}Z_n(\rho)}{\text{d}\rho} \bm{\hat{e}_r}
            -hn\frac{Z_n(\rho)}{\rho} \bm{\hat{e}_\phi}
            +\sqrt{k^2-h^2} Z_n(\rho) \bm{\hat{e}_z}
        \right)e^{i(n\phi+hz)}
\end{equation}
\par 正交性这里不验证。

\subsubsection{级数展开}

\par 考虑半径为 $a$ 的无限长圆柱体以及
一束入射平面波 $\bm{E}_i=\bm{E}_0 e^{ik\bm{\hat{e}_i}\cdot\bm{x}}$。
入射方向如图 \ref{fig:PlaneWave_Cylinder} 所示，
$\bm{\hat{e}_i}=-\sin\zeta \bm{\hat{e}_x} - \cos\zeta \bm{\hat{e}_z}$。
下面分别讨论入射电场 $\bm{E}_0$ 平行于和垂直于 $xz$ 平面的两种情况。
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.4\textwidth]{./image/PlaneWave_Cylinder.png}
    \caption{无限长圆柱平面波入射示意图}
    \label{fig:PlaneWave_Cylinder}
\end{figure}

\paragraph{$\bm{E}_0$ 平行于 $xz$ 平面}

\par 在这种情况下，入射电场可以写为
\begin{equation}
    \begin{aligned}
        \bm{E}_i &= E_0 (-\cos\zeta \bm{\hat{e}_x} + \sin\zeta \bm{\hat{e}_z}) 
        e^{-ik(r\sin\zeta\cos\phi + z\cos\zeta)}\\
        &= E_0 (-\cos\zeta\cos\phi \bm{\hat{e}_r}+\cos\zeta\sin\phi \bm{\hat{e}_\phi} + \sin\zeta \bm{\hat{e}_z}) 
        e^{-ik(r\sin\zeta\cos\phi + z\cos\zeta)}
    \end{aligned}
\end{equation}
\par 显然 $h$ 必须取值为 $-k\cos\zeta$。将 $\bm{E}_i$ 进行展开：
\begin{equation}
    \bm{E}_i=\sum_{n=-\infty}^{\infty}
    \left(
        A_n \bm{M}_n^{(1)} + B_n \bm{N}_n^{(1)}
    \right)
\end{equation}
\par 在进行具体计算前，先引入几个记号和公式：
\begin{align}
    \mathcal{G}_n^{(1)} &= \int_0^{2\pi} e^{-i(n\phi + \rho \cos \phi)} \text{d}\phi \\
    \mathcal{G}_n^{(2)} &= \int_0^{2\pi} e^{-i(n\phi + \rho \cos \phi)} \cos \phi \text{d}\phi \\
    \mathcal{G}_n^{(3)} &= \int_0^{2\pi} e^{-i(n\phi + \rho \cos \phi)} \sin \phi \text{d}\phi
\end{align}
\par 其中 $\rho = kr\sin\zeta$。利用第一类贝塞尔函数的积分表示式，有
\begin{gather}
    \mathcal{G}_n^{(1)} = 2\pi (-i)^n J_n(\rho)\\
    \mathcal{G}_n^{(2)} = 2\pi i (-i)^{n} J_n'(\rho)\\
    \mathcal{G}_n^{(3)} = 2\pi (-i)^{n} \frac{n}{\rho} J_n(\rho)  
\end{gather}
\par 这里以 $B_n$ 为例，为了具体计算展开系数，需要先计算其分子部分：
\begin{equation}
    \begin{aligned}
        \int_{0}^{2\pi}\bm{E}_i\cdot\bm{N}_{n}^{(1)*} \text{d}\phi
        &=E_0\frac{\sqrt{k^2-h^2}}{k}\left(
            ih\cos\zeta\frac{\text{d}J_n(\rho)}{\text{d}\rho}\mathcal{G}_n^{(2)} 
            -hn\cos\zeta \frac{J_n(\rho)}{\rho}\mathcal{G}_n^{(3)} 
            +\sqrt{k^2-h^2}\sin\zeta J_n(\rho)\mathcal{G}_n^{(1)}
        \right)\\
        &=2\pi E_0(-i)^{n}\frac{\sqrt{k^2-h^2}}{k}\left[
            \frac{h^2}{k}\left(\frac{\text{d}J_n(\rho)}{\text{d}\rho}\right)^2 
            +\frac{h^2n^2}{k} \frac{J_n^2(\rho)}{\rho^2} 
            +\frac{k^2-h^2}{k} J_n^2(\rho)
        \right]
    \end{aligned}
\end{equation}
\par 分母部分的计算如下：
\begin{equation}
    \begin{aligned}
        \int_{0}^{2\pi}|\bm{N}_{n}^{(1)}|^2 \text{d}\phi
        &=\frac{k^2-h^2}{k^2}\int_{0}^{2\pi}\left[
            h^2\left(
                \frac{\text{d}J_n(\rho)}{\text{d}\rho}
            \right)^2
            +h^2n^2\frac{J_n^2(\rho)}{\rho^2}
            +(k^2-h^2) J_n^2(\rho)
        \right] \text{d}\phi\\
        &=2\pi\frac{k^2-h^2}{k^2}\left[
            h^2\left(
                \frac{\text{d}J_n(\rho)}{\text{d}\rho}
            \right)^2
            +h^2n^2\frac{J_n^2(\rho)}{\rho^2}
            +(k^2-h^2) J_n^2(\rho)
        \right]
    \end{aligned}
\end{equation}
\par 综上我们得到 $B_n=E_0\dfrac{(-i)^n}{k\sin\zeta}$，同样进行一系列复杂的运算后得到
\begin{equation}
    \bm{E}_i=\sum_{n=-\infty}^{\infty} E_n \bm{N}_n^{(1)}, 
    \qquad \bm{H}_i=\frac{-ik}{\omega\mu}
    \sum_{n=-\infty}^{\infty} E_n \bm{M}_n^{(1)}
\end{equation}
\par 其中 $E_n=E_0\dfrac{(-i)^n}{k \sin\zeta}$。
为了满足边界条件，假设散射场和内部场的级数展开式为：
\begin{gather}
    \bm{E}_s = -\sum_{n=-\infty}^{\infty} E_n \left(
        ia_{n,\text{\Rmnum{1}}}\bm{M}_n^{(3)}+b_{n,\text{\Rmnum{1}}}\bm{N}_n^{(3)}
    \right)\\
    \bm{H}_s = \frac{ik}{\omega\mu}\sum_{n=-\infty}^{\infty} E_n \left(
        ia_{n,\text{\Rmnum{1}}}\bm{N}_n^{(3)}+b_{n,\text{\Rmnum{1}}}\bm{M}_n^{(3)}
    \right)
\end{gather}
\par 其中生成函数为
$H_n^{(1)}(kr\sin\zeta)e^{in\phi}e^{-ikz\cos\zeta}$，
$H_n^{(1)} = J_n + iY_n$ 是第一类汉克尔函数。 
\begin{gather}
    \bm{E}_1 = \sum_{n=-\infty}^{\infty} E_n \left(
        g_n\bm{M}_n^{(1)}+f_n\bm{N}_n^{(1)}
    \right)\\
    \bm{H}_1 = \frac{-ik_1}{\omega\mu_1}
        \sum_{n=-\infty}^{\infty} E_n \left(
        g_n\bm{N}_n^{(1)}+f_n\bm{M}_n^{(1)}
    \right)
\end{gather}
\par 其中 $k_1$ 和 $\mu_1$ 是圆柱体内部的波数和磁导率。生成函数为
$J_n(kr\sqrt{\beta^2-\cos^2\zeta})e^{in\phi}e^{-ikz\cos\zeta}$，$\beta$ 
为球内外波数的比值 $\dfrac{k_1}{k}$。
\par 在分界面处有边界条件：
\begin{equation}
    (\bm{E}_i+\bm{E}_s-\bm{E}_1)\times \bm{\hat{e}_r} =
    (\bm{H}_i+\bm{H}_s-\bm{H}_1)\times \bm{\hat{e}_r} = 0
\end{equation}
\par 代入可得在 $r=a$ 处有以下式子成立：
\begin{gather}
    E_{i\phi}+E_{s\phi}=E_{1\phi},
    \qquad E_{iz}+E_{sz}=E_{1z}\\
    H_{i\phi}+H_{s\phi}=H_{1\phi},
    \qquad H_{iz}+H_{sz}=H_{1z}
\end{gather}
\par 代入具体表达式后，可以得到四个方程：
\begin{gather}
    n \cos \zeta  J_n(\xi)
    +i\xi H_n^{(1)'}(\xi)a_{n,\text{\Rmnum{1}}}-n \cos \zeta H_n^{(1)}(\xi)b_{n,\text{\Rmnum{1}}}
    =-\eta J'_n(\eta)g_n+\frac{1}{\beta}n \cos \zeta J_n(\eta)f_n\\
    \frac{\xi^2}{\eta^2} J_n(\xi)
    - \frac{\xi^2}{\eta^2} H_n^{(1)}(\xi) b_{n,\text{\Rmnum{1}}}
    = \frac{1}{\beta}J_n(\eta)f_n\\
    \frac{\mu_1}{\mu} \xi  J'_n(\xi)
    -\frac{\mu_1}{\mu} \xi H_n^{(1)'}(\xi) b_{n,\text{\Rmnum{1}}} +i \frac{\mu_1}{\mu} n\cos \zeta  H_n^{(1)}(\xi)a_{n,\text{\Rmnum{1}}}
    =\beta \eta J'_n(\eta)f_n -n \cos \zeta  J_n(\eta)g_n\\
    i\frac{\mu_1}{\mu}\frac{\xi^2}{\eta^2} H_n^{(1)}(\xi) a_{n,\text{\Rmnum{1}}} 
    = - J_n(\eta) g_n
\end{gather}
\par 为了简化计算，考虑$ \mu = \mu_1$的情况，并且消去 $f_n$ 和 $g_n$：
\begin{equation}
    \begin{aligned}
        i\xi\left[
        \eta J_n(\eta)H_n^{(1)'}(\xi)
        -\xi J'_n(\eta)H_n^{(1)}(\xi)
        \right]a_{n,\text{\Rmnum{1}}}
        &+n\cos \zeta \ \eta J_n(\eta)H_n^{(1)}(\xi)\left(
            \frac{\xi^2}{\eta^2} - 1
        \right) b_{n,\text{\Rmnum{1}}}\\
        &= n \cos \zeta\ \eta J_n(\eta)J_n(\xi)\left(
            \frac{\xi^2}{\eta^2} - 1
        \right)
    \end{aligned}
\end{equation}
\begin{equation}
    \begin{aligned}
        n\cos \zeta\ \eta J_n(\eta)H_n^{(1)}(\xi)\left(
        \frac{\xi^2}{\eta^2} - 1
        \right)a_{n,\text{\Rmnum{1}}}
        +i\xi&\left[
            \beta^2\xi J'_n(\eta)H_n^{(1)}(\xi)-\eta J_n(\eta)H_n^{(1)'}(\xi)
        \right] b_{n,\text{\Rmnum{1}}}\\ 
        &=i\xi\left[
            \beta^2\xi J'_n(\eta)
            J_n(\xi)
            -\eta J_n(\eta)  J'_n(\xi)
        \right]
    \end{aligned}
\end{equation}
\par 解方程组后可以得到 $a_{n,\text{\Rmnum{1}}}$ 和 $b_{n,\text{\Rmnum{1}}}$:
\begin{gather}
    a_{n ,\text{\Rmnum{1}}} = \frac{C_n V_n - B_n D_n}{W_n V_n + i D_n^2}
    \qquad b_{n ,\text{\Rmnum{1}}} = \frac{W_n B_n + i D_n C_n}{W_n V_n + i D_n^2}
    \label{eq:scattered_coefficient_1}
\end{gather}
\begin{align}
    D_n &= n \cos \zeta \ \eta J_n(\eta) H_n^{(1)}(\xi) \left( \frac{\xi^2}{\eta^2} - 1 \right) \\
    B_n &= \xi \left[ \beta^2 \xi J_n'(\eta) J_n(\xi) - \eta J_n(\eta) J_n'(\xi) \right] \\
    C_n &= n \cos \zeta \ \eta J_n(\eta) J_n(\xi) \left( \frac{\xi^2}{\eta^2} - 1 \right) \\
    V_n &= \xi \left[ \beta^2 \xi J_n'(\eta) H_n^{(1)}(\xi) - \eta J_n(\eta) H_n^{(1)'}(\xi) \right] \\
    W_n &= i \xi \left[ \eta J_n(\eta) H_n^{(1)'}(\xi) - \xi J_n'(\eta) H_n^{(1)}(\xi) \right]
\end{align}
\par 其中 $\xi = k a \sin \zeta$，
$\eta = ka \sqrt{\beta^2 - \cos^2 \zeta}$，
$x=ka$。

\paragraph{$\bm{E}_0$ 垂直于 $xz$ 平面}

\par 在这种情况下，入射电场可以写为
\begin{equation}
    \bm{E}_i = E_0 \bm{\hat{e}_y} 
    e^{-ik(r\sin\zeta\cos\phi + z\cos\zeta)}
\end{equation}
\par 经过计算后可得
\begin{equation}
    \bm{E}_i=-i\sum_{n=-\infty}^{\infty} E_n \bm{M}_n^{(1)}
\end{equation}
\par 假设散射场级数展开式为：
\begin{gather}
    \bm{E}_s = \sum_{n=-\infty}^{\infty} E_n \left(
        ia_{n,\text{\Rmnum{2}}}\bm{M}_n^{(3)}+b_{n,\text{\Rmnum{2}}}\bm{N}_n^{(3)}
    \right)
\end{gather}
\par 利用边界条件，可以得到 $a_{n,\text{\Rmnum{2}}}$ 和 $b_{n,\text{\Rmnum{2}}}$:
\begin{gather}
    a_{n ,\text{\Rmnum{2}}} = -\frac{A_n V_n - iC_n D_n}{W_n V_n + i D_n^2}
    \qquad b_{n ,\text{\Rmnum{2}}} = -i\frac{C_n W_n + A_n D_n}{W_n V_n + i D_n^2}
    \label{eq:scattered_coefficient_2}
\end{gather}
\par 其中 $D_n$，$C_n$，$V_n$ 以及 $W_n$ 与前面定义相同，另外
\begin{equation}
    A_n = i\xi \left[ 
        \xi J_n'(\eta) J_n(\xi) - \eta J_n(\eta) J_n'(\xi) 
    \right]
\end{equation}

\section{非局域理论\cite{ruppin_extinction_2001}}

\par 真空中电磁波是没有纵波的，因为无源要求电磁波满足散度方程。
但是在金属纳米粒子中，如果考虑其内部的电子，
可以激发出相应的纵波，因此生成函数需要多添加一个纵波部分：
\begin{gather}
    \bm{M}_n = \nabla\times\left(
        \bm{\hat{e}_z} Z_n(\rho)e^{in\phi}e^{ihz}
    \right)\\
    \bm{N}_n = \frac{\nabla\times\bm{M}_n}{k}\\
    \bm{L}_n = \nabla\left(
        Z_n(\rho)e^{in\phi}e^{ihz}
    \right)
\end{gather}
\par 其中 $\rho=\sqrt{k^2-h^2}r$。
考虑入射方向沿着 $x$ 轴，电场极化方向沿着 $y$ 轴的平面波入射，此时 $h=0$。
\begin{equation}
    \bm{M}_n =
    k\left(
        in\frac{Z_n(kr)}{kr} \bm{\hat{e}_r}
        -\frac{\text{d}Z_n(kr)}{\text{d}(kr)} \bm{\hat{e}_\phi}
    \right)e^{in\phi}
\end{equation}
\begin{equation}
    \bm{N}_n =
            k Z_n(kr) \bm{\hat{e}_z}
        e^{in\phi}
\end{equation}
\begin{equation}
    \bm{L}_n =
    k\left(
        \frac{\text{d}Z_n(kr)}{\text{d}(kr)} \bm{\hat{e}_r}
        +in\frac{Z_n(kr)}{kr} \bm{\hat{e}_\phi}
    \right)e^{in\phi}
\end{equation}
\par 设 $E_n=\dfrac{i^n}{k}$，入射场级数展开式为：
\begin{gather}
    \bm{E}_i = \bm{\hat{e}_y}e^{ikr\cos\phi}
            = i \sum_{n=-\infty}^{\infty} E_n \bm{M}_n^{(1)}(kr)
            = \frac{i}{k} \sum_{n=-\infty}^{\infty} i^n \bm{M}_n^{(1)}(kr)\\
    \bm{H}_i = \frac{k}{\omega\mu_0}\sum_{n=-\infty}^{\infty}E_n\bm{N}_n^{(1)}(kr)
    = \sqrt{\varepsilon_m}\sqrt{\frac{\varepsilon_0}{\mu_0}}\sum_{n=-\infty}^{\infty}E_n\bm{N}_n^{(1)}(kr)
    = \frac{\sqrt{\varepsilon_m}}{k}\sqrt{\frac{\varepsilon_0}{\mu_0}}\sum_{n=-\infty}^{\infty}i^n\bm{N}_n^{(1)}(kr)
\end{gather}
\par 内部场级数展开式为：
\begin{gather}
    \bm{E}_{1,T} = \frac{i}{k_T} \sum_{n=-\infty}^{\infty} i^n g_n\bm{M}_n^{(1)}(k_Tr)\\
    \bm{H}_{1,T} = \frac{\sqrt{\varepsilon_m}}{k}\sqrt{\frac{\varepsilon_0}{\mu_0}}\sum_{n=-\infty}^{\infty}i^n g_n\bm{N}_n^{(1)}(k_Tr)\\
    \bm{E}_{1,L} = \frac{i}{k} \sum_{n=-\infty}^{\infty} i^n f_n\bm{L}_n^{(1)}(k_Lr)\\
    \bm{H}_{1,L} = 0
\end{gather}
\par 散射场级数展开式为：
\begin{gather}
    \bm{E}_s = \frac{i}{k} \sum_{n=-\infty}^{\infty} i^n a_n \bm{M}_n^{(3)}(kr)\\
    \bm{H}_s = \frac{\sqrt{\varepsilon_m}}{k}\sqrt{\frac{\varepsilon_0}{\mu_0}}\sum_{n=-\infty}^{\infty}i^n a_n \bm{N}_n^{(3)}(kr)
\end{gather}
\par 这里有两个可能会引起疑惑的点：
\begin{itemize}
    \item 为什么内部场和散射场的级数展开中只有 $\bm{M}_n$ 而没有 $\bm{N}_n$？\\
            因此 $\zeta=90^{\circ}$ 是一种特殊情况，电磁波垂直入射。即使假设 $\bm{N}_n$
            前面的系数代入计算，最后也会得到为 0。这种情况类似于式 \eqref{eq:scattered_coefficient_2} 中，
            由于当 $\zeta=90^{\circ}$ 时 $C_n$ 和 $D_n$ 为 0，$b_{n,\text{\Rmnum{2}}}=0$。
    \item 为什么内部场和散射场的级数展开看起来怪怪的？\\
            例如 $E_{1,L}$ 前面的系数为什么是 $\dfrac{i}{k}$ 而不是 $\dfrac{i}{k_L}$。这是为了
            方便在边界条件中的具体计算，实际上这个系数并不影响最终的结果。
            需要注意的是，用于计算消光截面的系数一定是归一化后的系数，也就是散射场与入射场的全部系数比值：
            \begin{equation}
                \text{scattering coefficient} = \frac{ia_n/k}{i/k} = a_n
            \end{equation}
\end{itemize}
\par 在分界面处有边界条件：
\begin{equation}
    (\bm{E}_i+\bm{E}_s-\bm{E}_{1,T}-\bm{E}_{1,L})\times \bm{\hat{e}_r} =
    (\bm{H}_i+\bm{H}_s-\bm{H}_{1,T})\times \bm{\hat{e}_r} = 0
\end{equation}
\par 也就是：
\begin{gather}
    J_n'(ka)+a_n H_n^{(1)'}(ka) = g_n J_n'(k_T a) - \frac{in}{k a}f_n J_n(k_L a)\\
    \sqrt{\varepsilon_m}\left[ J_n(ka) + a_n H_n^{(1)}(ka) \right]
    = \sqrt{\varepsilon_T} g_n J_n(k_T a)
\end{gather}
\par 另外还需要满足额外的边界条件：
\begin{equation}
    \bm{\hat{e}_r} \cdot(\bm{E}_{i} + \bm{E}_{s}) = 
    \bm{\hat{e}_r} \cdot(\bm{E}_{1,T} + \bm{E}_{1,L})
\end{equation}
\par 也就是：
\begin{gather}
    \frac{n}{k a} J_n(ka) + \frac{n}{k a} a_n H_n^{(1)}(ka)
    = \frac{n}{k_T a} g_n J_n(k_T a) - i\frac{k_L}{k} f_n J_n'(k_L a)
\end{gather}
\par 通过以上式子可以解得：
\begin{gather}
    a_n = -\frac{c_nJ_n(ka)+\sqrt{\varepsilon_m}J_n(ka)J'_n(k_Ta)
    -\sqrt{\varepsilon_T}J'_n(ka)J_n(k_Ta)}
    {c_nH_n^{(1)}(ka)+\sqrt{\varepsilon_m}H_n^{(1)}(ka)J'_n(k_Ta)
    -\sqrt{\varepsilon_T}H_n^{(1)'}(ka)J_n(k_Ta)}
\end{gather}
\par 其中
\begin{equation}
    c_n = \frac{n^2}{k_La}\frac{J_n(k_La)}{J'_n(k_La)}
    J_n(k_Ta)\left(
        \frac{\sqrt{\varepsilon_T}}{ka}
        -\frac{\sqrt{\varepsilon_m}}{k_Ta}
    \right)
\end{equation}

% ===============================================

\newpage
\printbibliography

\end{document}